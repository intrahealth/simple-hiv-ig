<?xml version="1.0" encoding="UTF-8"?>

<Library xmlns="http://hl7.org/fhir">
  <id value="HIVSimpleDemog"/>
  <text>
    <status value="generated"/><div xmlns="http://www.w3.org/1999/xhtml"><h2>Contents</h2><p><code>text/cql</code></p><pre><code class="language-sql">library HIVSimpleDemog version '0.1.0'

using FHIR version '4.0.1'

include FHIRHelpers version '4.0.1'
include FHIRCommon version '0.1.0' called FC
include AgeRanges version '0.1.0' called AR

// SNOMED-CT, International Edition
codesystem "SNOMED-CT": 'http://snomed.info/sct' version 'http://snomed.info/sct/900000000000207008'

// LOINC, 2.63+
codesystem "LOINC": 'http://loinc.org'

// inclusive (closed) boundaries are indicated with square brackets,
// and exclusive (open) boundaries are indicated with parentheses
parameter MeasurementPeriod default Interval[@1970-01-01, @2021-01-01)

context Patient

define "Sex": Patient.gender

// not working as expected
define "Age Group Test":
  AR."Age Group".code

  define Patient0To5AndFemale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 0
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 5
      and Patient.gender = 'female'

  define Patient5To15AndFemale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 5
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 15
      and Patient.gender = 'female'

  define Patient15To25AndFemale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 15
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 25
      and Patient.gender = 'female'

  define Patient25To50AndFemale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 25
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 50
      and Patient.gender = 'female'

  define Patient50To65AndFemale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 50
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 65
      and Patient.gender = 'female'

  define Patient65ToHighestAndFemale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 65
      and Patient.gender = 'female'

  define Patient0To5AndMale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 0
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 5
      and Patient.gender = 'male'

  define Patient5To15AndMale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 5
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 15
      and Patient.gender = 'male'

  define Patient15To25AndMale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 15
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 25
      and Patient.gender = 'male'

  define Patient25To50AndMale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 25
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 50
      and Patient.gender = 'male'

  define Patient50To65AndMale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 50
      and AgeInYearsAt(start of "MeasurementPeriod") &lt; 65
      and Patient.gender = 'male'

  define Patient65ToHighestAndMale:
    AgeInYearsAt(start of "MeasurementPeriod") &gt;= 65
      and Patient.gender = 'male'

define "Initial Population": true

define "Denominator": true

define "Numerator": true
</code></pre><p><code>No Content</code> (<code>application/elm+xml</code>)</p></div>
  </text>
  <url value="https://github.com/intrahealth/simple-hiv-ig/Library/HIVSimpleDemog"/>
  <version value="0.1.0"/>
  <name value="HIVSimpleDemog"/>
  <title value="HIVSimpleDemog"/>
  <status value="active"/>
  <experimental value="true"/>
  <type>
    <coding>
      <system value="http://terminology.hl7.org/CodeSystem/library-type"/>
      <code value="logic-library"/>
    </coding>
  </type>
  <date value="2021-06-29T01:02:10+00:00"/>
  <publisher value="IntraHealth International"/>
  <contact>
    <telecom>
      <system value="url"/>
      <value value="http://hl7.org/Special/committees/[something]"/>
    </telecom>
  </contact>
  <content>
    <contentType value="text/cql"/>
    <data value="bGlicmFyeSBISVZTaW1wbGVEZW1vZyB2ZXJzaW9uICcwLjEuMCcKCnVzaW5nIEZISVIgdmVyc2lvbiAnNC4wLjEnCgppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzQuMC4xJwppbmNsdWRlIEZISVJDb21tb24gdmVyc2lvbiAnMC4xLjAnIGNhbGxlZCBGQwppbmNsdWRlIEFnZVJhbmdlcyB2ZXJzaW9uICcwLjEuMCcgY2FsbGVkIEFSCgovLyBTTk9NRUQtQ1QsIEludGVybmF0aW9uYWwgRWRpdGlvbgpjb2Rlc3lzdGVtICJTTk9NRUQtQ1QiOiAnaHR0cDovL3Nub21lZC5pbmZvL3NjdCcgdmVyc2lvbiAnaHR0cDovL3Nub21lZC5pbmZvL3NjdC85MDAwMDAwMDAwMDAyMDcwMDgnCgovLyBMT0lOQywgMi42MysKY29kZXN5c3RlbSAiTE9JTkMiOiAnaHR0cDovL2xvaW5jLm9yZycKCi8vIGluY2x1c2l2ZSAoY2xvc2VkKSBib3VuZGFyaWVzIGFyZSBpbmRpY2F0ZWQgd2l0aCBzcXVhcmUgYnJhY2tldHMsCi8vIGFuZCBleGNsdXNpdmUgKG9wZW4pIGJvdW5kYXJpZXMgYXJlIGluZGljYXRlZCB3aXRoIHBhcmVudGhlc2VzCnBhcmFtZXRlciBNZWFzdXJlbWVudFBlcmlvZCBkZWZhdWx0IEludGVydmFsW0AxOTcwLTAxLTAxLCBAMjAyMS0wMS0wMSkKCmNvbnRleHQgUGF0aWVudAoKZGVmaW5lICJTZXgiOiBQYXRpZW50LmdlbmRlcgoKLy8gbm90IHdvcmtpbmcgYXMgZXhwZWN0ZWQKZGVmaW5lICJBZ2UgR3JvdXAgVGVzdCI6CiAgQVIuIkFnZSBHcm91cCIuY29kZQoKICBkZWZpbmUgUGF0aWVudDBUbzVBbmRGZW1hbGU6CiAgICBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPj0gMAogICAgICBhbmQgQWdlSW5ZZWFyc0F0KHN0YXJ0IG9mICJNZWFzdXJlbWVudFBlcmlvZCIpIDwgNQogICAgICBhbmQgUGF0aWVudC5nZW5kZXIgPSAnZmVtYWxlJwoKICBkZWZpbmUgUGF0aWVudDVUbzE1QW5kRmVtYWxlOgogICAgQWdlSW5ZZWFyc0F0KHN0YXJ0IG9mICJNZWFzdXJlbWVudFBlcmlvZCIpID49IDUKICAgICAgYW5kIEFnZUluWWVhcnNBdChzdGFydCBvZiAiTWVhc3VyZW1lbnRQZXJpb2QiKSA8IDE1CiAgICAgIGFuZCBQYXRpZW50LmdlbmRlciA9ICdmZW1hbGUnCgogIGRlZmluZSBQYXRpZW50MTVUbzI1QW5kRmVtYWxlOgogICAgQWdlSW5ZZWFyc0F0KHN0YXJ0IG9mICJNZWFzdXJlbWVudFBlcmlvZCIpID49IDE1CiAgICAgIGFuZCBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPCAyNQogICAgICBhbmQgUGF0aWVudC5nZW5kZXIgPSAnZmVtYWxlJwoKICBkZWZpbmUgUGF0aWVudDI1VG81MEFuZEZlbWFsZToKICAgIEFnZUluWWVhcnNBdChzdGFydCBvZiAiTWVhc3VyZW1lbnRQZXJpb2QiKSA+PSAyNQogICAgICBhbmQgQWdlSW5ZZWFyc0F0KHN0YXJ0IG9mICJNZWFzdXJlbWVudFBlcmlvZCIpIDwgNTAKICAgICAgYW5kIFBhdGllbnQuZ2VuZGVyID0gJ2ZlbWFsZScKCiAgZGVmaW5lIFBhdGllbnQ1MFRvNjVBbmRGZW1hbGU6CiAgICBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPj0gNTAKICAgICAgYW5kIEFnZUluWWVhcnNBdChzdGFydCBvZiAiTWVhc3VyZW1lbnRQZXJpb2QiKSA8IDY1CiAgICAgIGFuZCBQYXRpZW50LmdlbmRlciA9ICdmZW1hbGUnCgogIGRlZmluZSBQYXRpZW50NjVUb0hpZ2hlc3RBbmRGZW1hbGU6CiAgICBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPj0gNjUKICAgICAgYW5kIFBhdGllbnQuZ2VuZGVyID0gJ2ZlbWFsZScKCiAgZGVmaW5lIFBhdGllbnQwVG81QW5kTWFsZToKICAgIEFnZUluWWVhcnNBdChzdGFydCBvZiAiTWVhc3VyZW1lbnRQZXJpb2QiKSA+PSAwCiAgICAgIGFuZCBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPCA1CiAgICAgIGFuZCBQYXRpZW50LmdlbmRlciA9ICdtYWxlJwoKICBkZWZpbmUgUGF0aWVudDVUbzE1QW5kTWFsZToKICAgIEFnZUluWWVhcnNBdChzdGFydCBvZiAiTWVhc3VyZW1lbnRQZXJpb2QiKSA+PSA1CiAgICAgIGFuZCBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPCAxNQogICAgICBhbmQgUGF0aWVudC5nZW5kZXIgPSAnbWFsZScKCiAgZGVmaW5lIFBhdGllbnQxNVRvMjVBbmRNYWxlOgogICAgQWdlSW5ZZWFyc0F0KHN0YXJ0IG9mICJNZWFzdXJlbWVudFBlcmlvZCIpID49IDE1CiAgICAgIGFuZCBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPCAyNQogICAgICBhbmQgUGF0aWVudC5nZW5kZXIgPSAnbWFsZScKCiAgZGVmaW5lIFBhdGllbnQyNVRvNTBBbmRNYWxlOgogICAgQWdlSW5ZZWFyc0F0KHN0YXJ0IG9mICJNZWFzdXJlbWVudFBlcmlvZCIpID49IDI1CiAgICAgIGFuZCBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPCA1MAogICAgICBhbmQgUGF0aWVudC5nZW5kZXIgPSAnbWFsZScKCiAgZGVmaW5lIFBhdGllbnQ1MFRvNjVBbmRNYWxlOgogICAgQWdlSW5ZZWFyc0F0KHN0YXJ0IG9mICJNZWFzdXJlbWVudFBlcmlvZCIpID49IDUwCiAgICAgIGFuZCBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPCA2NQogICAgICBhbmQgUGF0aWVudC5nZW5kZXIgPSAnbWFsZScKCiAgZGVmaW5lIFBhdGllbnQ2NVRvSGlnaGVzdEFuZE1hbGU6CiAgICBBZ2VJblllYXJzQXQoc3RhcnQgb2YgIk1lYXN1cmVtZW50UGVyaW9kIikgPj0gNjUKICAgICAgYW5kIFBhdGllbnQuZ2VuZGVyID0gJ21hbGUnCgpkZWZpbmUgIkluaXRpYWwgUG9wdWxhdGlvbiI6IHRydWUKCmRlZmluZSAiRGVub21pbmF0b3IiOiB0cnVlCgpkZWZpbmUgIk51bWVyYXRvciI6IHRydWUK"/>
  </content>
  <content>
    <contentType value="application/elm+xml"/>
  </content>
</Library>