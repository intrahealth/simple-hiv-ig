@prefix fhir: <http://hl7.org/fhir/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# - resource -------------------------------------------------------------------

<https://github.com/intrahealth/simple-hiv-ig/Library/HIVSimpleViralLoad> a fhir:Library;
  fhir:nodeRole fhir:treeRoot;
  fhir:Resource.id [ fhir:value "HIVSimpleViralLoad"];
  fhir:DomainResource.text [
     fhir:Narrative.status [ fhir:value "generated" ];
     fhir:Narrative.div "<div xmlns=\"http://www.w3.org/1999/xhtml\"><h2>Contents</h2><p><code>text/cql</code></p><pre><code class=\"language-sql\">library HIVSimpleViralLoad version '0.1.0'\n\nusing FHIR version '4.0.1'\n\ninclude FHIRHelpers version '4.0.1'\ninclude FHIRCommon version '0.1.0' called FC\ninclude AgeRanges version '0.1.0' called AR\n\n// SNOMED-CT, International Edition\ncodesystem \"SNOMED-CT\": 'http://snomed.info/sct' version 'http://snomed.info/sct/900000000000207008'\n\n// LOINC, 2.63+\ncodesystem \"LOINC\": 'http://loinc.org'\n\n// Viral load\n// * LOINC code 25836-8\n// * \"HIV 1 RNA NAA+probe (Specimen)\"\n// * Units: copies/mL\n// * Suppressed viral load (&lt;1000 copies/mL)\n// * Used range of 200 (very low) -&gt; 1000000 (very high)\ncode \"HIV 1 RNA NAA+probe (Specimen)\": '25836-8' from \"LOINC\" display 'HIV 1 RNA NAA+probe (Specimen)'\n\ncontext Patient\n\n// all these seem to workie\n\ndefine \"Suppressed\":\n  [Observation: \"HIV 1 RNA NAA+probe (Specimen)\"] Observation\n    where Observation.value &lt; 1000 'copies/mL'\n\ndefine \"Unsuppressed\":\n  [Observation: \"HIV 1 RNA NAA+probe (Specimen)\"] Observation\n    where Observation.value &gt;= 1000 'copies/mL'\n\ndefine \"Viral Load Test Result\":\n  [\"Observation\": \"HIV 1 RNA NAA+probe (Specimen)\"] Observation\n    where Observation.value is not null\n\n// below works\ndefine \"Living with HIV and on ART with suppressed viral load results (&lt;1000 copies/mL)\":\n  [\"Observation\": \"HIV 1 RNA NAA+probe (Specimen)\"] Observation\n    where Observation.value &lt; 1000 'copies/mL'\n\ndefine \"Living with HIV and on ART with unsuppressed viral load results (&gt;1000 copies/mL)\":\n  [\"Observation\": \"HIV 1 RNA NAA+probe (Specimen)\"] Observation\n    where Observation.value &gt;= 1000 'copies/mL'\n\ndefine \"Sex\": Patient.gender\n\ndefine \"Initial Population\": true\n\ndefine \"Denominator\": true\n\ndefine \"Numerator\":\n  \"Unsuppressed\"\n</code></pre><p><code>No Content</code> (<code>application/elm+xml</code>)</p></div>"
  ];
  fhir:Library.url [ fhir:value "https://github.com/intrahealth/simple-hiv-ig/Library/HIVSimpleViralLoad"];
  fhir:Library.version [ fhir:value "0.1.0"];
  fhir:Library.name [ fhir:value "HIVSimpleViralLoad"];
  fhir:Library.title [ fhir:value "HIVSimpleViralLoad"];
  fhir:Library.status [ fhir:value "active"];
  fhir:Library.experimental [ fhir:value "true"^^xsd:boolean];
  fhir:Library.type [
     fhir:CodeableConcept.coding [
       fhir:index 0;
       fhir:Coding.system [ fhir:value "http://terminology.hl7.org/CodeSystem/library-type" ];
       fhir:Coding.code [ fhir:value "logic-library" ]
     ]
  ];
  fhir:Library.date [ fhir:value "2021-06-29T01:02:10+00:00"^^xsd:dateTime];
  fhir:Library.publisher [ fhir:value "IntraHealth International"];
  fhir:Library.contact [
     fhir:index 0;
     fhir:ContactDetail.telecom [
       fhir:index 0;
       fhir:ContactPoint.system [ fhir:value "url" ];
       fhir:ContactPoint.value [ fhir:value "http://hl7.org/Special/committees/[something]" ]
     ]
  ];
  fhir:Library.content [
     fhir:index 0;
     fhir:Attachment.contentType [ fhir:value "text/cql" ];
     fhir:Attachment.data [ fhir:value "bGlicmFyeSBISVZTaW1wbGVWaXJhbExvYWQgdmVyc2lvbiAnMC4xLjAnCgp1c2luZyBGSElSIHZlcnNpb24gJzQuMC4xJwoKaW5jbHVkZSBGSElSSGVscGVycyB2ZXJzaW9uICc0LjAuMScKaW5jbHVkZSBGSElSQ29tbW9uIHZlcnNpb24gJzAuMS4wJyBjYWxsZWQgRkMKaW5jbHVkZSBBZ2VSYW5nZXMgdmVyc2lvbiAnMC4xLjAnIGNhbGxlZCBBUgoKLy8gU05PTUVELUNULCBJbnRlcm5hdGlvbmFsIEVkaXRpb24KY29kZXN5c3RlbSAiU05PTUVELUNUIjogJ2h0dHA6Ly9zbm9tZWQuaW5mby9zY3QnIHZlcnNpb24gJ2h0dHA6Ly9zbm9tZWQuaW5mby9zY3QvOTAwMDAwMDAwMDAwMjA3MDA4JwoKLy8gTE9JTkMsIDIuNjMrCmNvZGVzeXN0ZW0gIkxPSU5DIjogJ2h0dHA6Ly9sb2luYy5vcmcnCgovLyBWaXJhbCBsb2FkCi8vICogTE9JTkMgY29kZSAyNTgzNi04Ci8vICogIkhJViAxIFJOQSBOQUErcHJvYmUgKFNwZWNpbWVuKSIKLy8gKiBVbml0czogY29waWVzL21MCi8vICogU3VwcHJlc3NlZCB2aXJhbCBsb2FkICg8MTAwMCBjb3BpZXMvbUwpCi8vICogVXNlZCByYW5nZSBvZiAyMDAgKHZlcnkgbG93KSAtPiAxMDAwMDAwICh2ZXJ5IGhpZ2gpCmNvZGUgIkhJViAxIFJOQSBOQUErcHJvYmUgKFNwZWNpbWVuKSI6ICcyNTgzNi04JyBmcm9tICJMT0lOQyIgZGlzcGxheSAnSElWIDEgUk5BIE5BQStwcm9iZSAoU3BlY2ltZW4pJwoKY29udGV4dCBQYXRpZW50CgovLyBhbGwgdGhlc2Ugc2VlbSB0byB3b3JraWUKCmRlZmluZSAiU3VwcHJlc3NlZCI6CiAgW09ic2VydmF0aW9uOiAiSElWIDEgUk5BIE5BQStwcm9iZSAoU3BlY2ltZW4pIl0gT2JzZXJ2YXRpb24KICAgIHdoZXJlIE9ic2VydmF0aW9uLnZhbHVlIDwgMTAwMCAnY29waWVzL21MJwoKZGVmaW5lICJVbnN1cHByZXNzZWQiOgogIFtPYnNlcnZhdGlvbjogIkhJViAxIFJOQSBOQUErcHJvYmUgKFNwZWNpbWVuKSJdIE9ic2VydmF0aW9uCiAgICB3aGVyZSBPYnNlcnZhdGlvbi52YWx1ZSA+PSAxMDAwICdjb3BpZXMvbUwnCgpkZWZpbmUgIlZpcmFsIExvYWQgVGVzdCBSZXN1bHQiOgogIFsiT2JzZXJ2YXRpb24iOiAiSElWIDEgUk5BIE5BQStwcm9iZSAoU3BlY2ltZW4pIl0gT2JzZXJ2YXRpb24KICAgIHdoZXJlIE9ic2VydmF0aW9uLnZhbHVlIGlzIG5vdCBudWxsCgovLyBiZWxvdyB3b3JrcwpkZWZpbmUgIkxpdmluZyB3aXRoIEhJViBhbmQgb24gQVJUIHdpdGggc3VwcHJlc3NlZCB2aXJhbCBsb2FkIHJlc3VsdHMgKDwxMDAwIGNvcGllcy9tTCkiOgogIFsiT2JzZXJ2YXRpb24iOiAiSElWIDEgUk5BIE5BQStwcm9iZSAoU3BlY2ltZW4pIl0gT2JzZXJ2YXRpb24KICAgIHdoZXJlIE9ic2VydmF0aW9uLnZhbHVlIDwgMTAwMCAnY29waWVzL21MJwoKZGVmaW5lICJMaXZpbmcgd2l0aCBISVYgYW5kIG9uIEFSVCB3aXRoIHVuc3VwcHJlc3NlZCB2aXJhbCBsb2FkIHJlc3VsdHMgKD4xMDAwIGNvcGllcy9tTCkiOgogIFsiT2JzZXJ2YXRpb24iOiAiSElWIDEgUk5BIE5BQStwcm9iZSAoU3BlY2ltZW4pIl0gT2JzZXJ2YXRpb24KICAgIHdoZXJlIE9ic2VydmF0aW9uLnZhbHVlID49IDEwMDAgJ2NvcGllcy9tTCcKCmRlZmluZSAiU2V4IjogUGF0aWVudC5nZW5kZXIKCmRlZmluZSAiSW5pdGlhbCBQb3B1bGF0aW9uIjogdHJ1ZQoKZGVmaW5lICJEZW5vbWluYXRvciI6IHRydWUKCmRlZmluZSAiTnVtZXJhdG9yIjoKICAiVW5zdXBwcmVzc2VkIgo="^^xsd:base64Binary ]
  ], [
     fhir:index 1;
     fhir:Attachment.contentType [ fhir:value "application/elm+xml" ]
  ] .

# - ontology header ------------------------------------------------------------

<https://github.com/intrahealth/simple-hiv-ig/Library/HIVSimpleViralLoad.ttl> a owl:Ontology;
  owl:imports fhir:fhir.ttl .

# -------------------------------------------------------------------------------------

